<ons-page id="cats">
    <script>
        const page = ons.getScriptPage();
        const list = page.querySelector('ons-list');

        function edit_cat(name) {

        }


        function new_cat() {

            ons.notification.prompt({
                message: "Enter new cat's name",
                title: "'New cat",
                cancelable: true,
                buttonLabels: ["Cancel", "OK"]
            }).then(name => {
                if (name) {
                    rpc("cats.new", { name: name }, result => {
                        loadPage('editcat.html', { 'data': { 'name': name } });
                    });
                }
            })
        }

        //tab is shown
        page.onShow = function () {


            //get new list data
            rpc("cats.get_all", {}, function (result) {

                //clear list
                list.querySelectorAll('ons-list-item').forEach(e => e.remove());

                //fill it
                result.forEach(cat => {
                    e = ons.createElement(/*html*/`
                    <ons-list-item>
                        <div class="center">
                            ${cat.name}
                        </div>
                        <div class="right">
                            ${cat.weight.toFixed(0) + "g"}
                        </div>
                        <div>moi</div>
                    </ons-list-item>
                    `)

                    list.append(e);
                });


            })

        };
    </script>
    <div class="msg" style='font-weight: bold;'>
        Loading...
    </div>


    <ons-list>
        <ons-list-header>My cats</ons-list-header>
        <ons-progress-bar indeterminate class="global-progress"></ons-progress-bar>
    </ons-list>

    <ons-fab position="bottom right" onClick="new_cat()">
        <ons-icon icon="md-plus"></ons-icon>
    </ons-fab>


</ons-page>